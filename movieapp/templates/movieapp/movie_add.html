{% extends 'movieapp/user_profile2.html' %}
{% load widget_tweaks %}
{% block title %}Add Movie{% endblock %}
{% block style %}
<style>

.tag {
    font-size: 14px;
    padding: .3em .4em .4em;
    margin: 0 .1em;
    background-color:blue;
    color:white;
  }
  
  .tag a {
    color: #bbb;
    cursor: pointer;
    opacity: 0.6;
  }
  
  .tag a {
    margin: 0 0 0 .3em;
  }
</style>
{% endblock %}
{% block scripts %}

<script>
    $(function() {
        $( ".datepicker" ).datepicker({
        changeMonth: true,
        changeYear: true,
        // You can put more options here.
    
        });
    });

$(document).ready(function(){
    $('#artists_hid').val("|");
 $.ajaxSetup({ cache: false });
 $('#artist_search').keyup(function(){
  $('#result').html('');
  $('#state').val('');
  var searchField = $('#artist_search').val();
  var expression = new RegExp(searchField, "i");
  //alert(searchField)
  $.getJSON("{% url 'artist-autocomplete' %}",data="q="+searchField,function(data) {
    //alert(data)
   $.each(JSON.parse(data), function(key, value){
    //alert(value+" -- "+expression);
    
     $('#result').append('<li class="list-group-item link-class"><span class="text-muted">'+value.fields.name+"("+value.pk+")"+'</span></li>');
    
   });   
  });
 });
 
 $('#result').on('click', 'li', function() {
  var click_text = $(this).text();
  //alert(click_text[0]);
  $('#artist_search').val($.trim(click_text));
  
  $("#result").html('');
 });
});


function addArtist(){

    var pk = $("#artist_search").val().split('(')[1].split(')')[0];
  //alert("num-->"+pk);
  var hval = $('#artists_hid').attr('value');
  //alert("val-->"+hval);
  var hval=hval+pk+"|";
  $('#artists_hid').val(hval);
  //alert($('#artists_hid').attr('value'));

}



</script>

{% endblock %}

{% block profile-content%}
    <!-- <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <input type="submit" value="Create Movie">
    </form> -->
    <div class="row">

            <div class="col-sm-9 mx-auto ">
                    
                    <form class="p-3 mt-5 form-horizontal" enctype="multipart/form-data" method="POST">
                            <p class="h1 text-center">Add Movie</p>
                        {% csrf_token %}
                            <fieldset>
                                <div class="control-group">
                                    <!-- Username -->
                                    <label class="control-label"  for="name">Name</label>
                                    <div class="controls">
                                            {% render_field form.name class+="form-control" %}
                                    </div>
                                </div>
                                <!-- <div class="form-inline"> -->
                                <div class="form-group row p-3">
                                    <!-- <div class="control-group"> -->
                                    <!-- Username -->
                                    
                                    <!-- <div class="controls"> -->
                                        <div class="col-xs-6">
                                            <label class="control-label"  for="genre">Genre</label>
                                                {% render_field form.genre class+="form-control" %}
                                        </div>
                                            
                                        <div class="col-xs-6 ml-5">
                                            <label class="control-label" for="release_date">Release Date</label>
                                                    {% render_field form.release_date class+="form-control" %}
                                        </div>
                                            
                                    <!-- </div> -->
                                    
                                    
                                    


                                    <!-- </div> -->
                                </div>
                                <!-- </div> -->
                                
                                    
                                
                                <div class="form-row">
                                    <div class="form-group col-md-8">
                                        <input id="artist_search" class="form-control" autocomplete="off">
                                        <ul class="list-group" id="result"></ul>
                                        <div id="tags">
                                                <span class="tag label label-info">
                                                    <span>Example Tag</span>
                                                </span>
                                                <span class="tag label label-info">
                                                    <span>Example Tag</span> 
                                                </span>

                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <button class="btn btn-info" type="button" onclick="addArtist()">Add</button>
                                        <input type="hidden" name="artists" id="artists_hid" value="|">
                                    </div>
                    
                                </div>
                                                          
                
                                        
                        
                                <div class="control-group">
                                <!-- Password-->
                                <label class="control-label" for="description">Description</label>
                                <div class="controls">
                                        {% render_field form.description class+="form-control" %}
                                </div>
                                </div>
                        
                                <div class="control-group">
                                <!-- Password -->
                                <label class="control-label"  for="image">Poster</label>
                                <div class="controls">
                                        {% render_field form.image  %}
                                </div>
                                </div>
                        
                                <div class="control-group">
                                <!-- Button -->
                                <div class="controls">
                                    <button class="btn btn-success btn-block">Add Movie</button>
                                </div>
                                </div>
                            </fieldset>
                        </form>
            </div>
        </div>
{% endblock %}